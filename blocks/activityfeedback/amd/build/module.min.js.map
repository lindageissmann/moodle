{"version":3,"sources":["../src/module.js"],"names":["init","args","userid","parseInt","courseid","rootPath","rootpath","window","console","log","displayPictures","Ajax","call","methodname","done","pixData","activities","document","getElementsByClassName","activity","activityInstance","courseModuleId","id","substring","container","createElement","className","setAttribute","imgMain","src","classList","add","popover","addEventListener","event","contains","target","remove","which","visiblePopover","querySelector","num","figureOpt","length","imgOpt","url","alt","name","key","figCaptOpt","textContent","append","appendChild","fbMainBtns","btn","openFeedback","fbBtns","setFeedback","getFeedback","fail","notification","exception","mainBtn","cmId","getAttribute","nextElementSibling","fbData","isBtnMainUpdated","fbItem","cmid","btnMain","fbPix","querySelectorAll","pix","fbid","getFeedbackForActivity","fbname","parentElement","previousElementSibling","require","ajax","promises","component","stringid","response","ex"],"mappings":"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","sourcesContent":["//https://docs.moodle.org/dev/Javascript_Modules\n//only functions which are exported will be callable from outside the module\n//if the size of the params array is too large (> 1Kb), this will produce a developer warning. Do not attempt\n//to pass large amounts of data through this function, it will pollute the page size.\n//A preferred approach is to pass css selectors for DOM elements that contain data-attributes for any required data,\n//or fetch data via ajax in the background.\n//https://moodle.org/mod/forum/discuss.php?d=378112#p1524459\n// zwar veraltet, aber camel case hier ok: https://docs.moodle.org/dev/Javascript/Coding_Style\n// (auch in Bsp benutzt: https://docs.moodle.org/dev/Javascript_Modules)\n//todolig auf camelCase umstellen\n//import $ from 'jquery';\n//import jquery from 'jquery';\n//import * as Str from 'core/str';\nimport Ajax from 'core/ajax';\n//import {exception as displayError} from 'core/notification';\nimport notification from 'core/notification';\n//import * as mdlcfg from 'core/config';\n//define(['jquery', 'core/ajax', 'core/notification']);\nexport const init = (args) => {\n    const userid = parseInt(args.userid);\n    const courseid = parseInt(args.courseid);\n    const rootPath = args.rootpath;\n    //const elems = document.querySelectorAll('[id^=module-]');\n    //warum fkt. hier jquery?\n    //jquery: .done(), .success, .fail, .always\n    //.then, .when\n    window.console.log(\"config:\");\n    //window.console.log(mdlcfg.wwwroot);\n    window.rootPath = args.rootpath;\n    //import gibt Fehler\n    //https://docs.moodle.org/dev/Useful_core_Javascript_modules\n    //https://stackoverflow.com/questions/5915258/how-to-load-external-js-file-into-moodle\n\n    //require:\n    //https://docs.moodle.org/dev/AJAX\n    //import:\n    //https://docs.moodle.org/dev/Javascript_Modules\n    //Uncaught undefined\n    //window.console.log(rootPath);\n    displayPictures(rootPath, courseid, userid);\n    //getFeedback(courseid, userid); // todolig! gibt hier race condition, dass getFeedback end done noch vor displayPict start done\n};\n\nfunction displayPictures(rootPath, courseid, userid)\n{\n    window.console.log(\"displayPictures: start\");\n    Ajax.call([\n        {\n            methodname: 'block_activityfeedback_get_pix_data',\n            args: {},\n            done: function (pixData) {\n                window.console.log(\"displayPictures: start done\");\n                const activities = document.getElementsByClassName(\"activity\");\n                for (const activity of activities)\n                {\n                    let activityInstance = activity.getElementsByClassName(\"activityinstance\")[0];\n                    // check if exists, because e.g. activity 'label' has no <div> child element with class 'activityinstance'\n                    if(activityInstance !== undefined && activityInstance !== null) {\n                        const courseModuleId = (activity.id).substring(7); // extract xx from id=module-xx\n                        let container = document.createElement(\"figure\");\n                        container.className = \"block_activityfeedback_container\";\n                        container.setAttribute(\"data-cmid\", courseModuleId);\n                        //node.classList.add('MyClass');\n                        // main button for feedback\n                        //let figureMain = document.createElement(\"figure\");\n                        let imgMain = document.createElement(\"img\");\n                        imgMain.className = \"block_activityfeedback_btn_main\";\n                        imgMain.src = rootPath + \"/blocks/activityfeedback/pix/thumbsup.png\";//todo: bild eckig via css rund machen\n                        //imgMain.alt = Str.get_string('activityfeedback', 'block_activityfeedback'); //todolig\n                        imgMain.setAttribute(\"data-cmid\", courseModuleId);\n                        //let figCaptMain = document.createElement(\"figcaption\");\n                        //figCaptMain.textContent = Str.get_string('activityfeedback', 'block_activityfeedback');\n                        //window.console.log(Str.get_string('activityfeedback', 'block_activityfeedback'));\n                        //window.console.log(formal);\n                        //figureMain.append(imgMain, figCaptMain);\n                        //container.append(figureMain);\n\n                        //Achtung: neu ist glaube ich scrollbalken wegen Bildern, auch senkrecht innerhalb!\n\n\n\n                        imgMain.classList.add(\"popover_title\");\n                        container.classList.add(\"popover_wrapper\");\n                        let popover = document.createElement(\"figure\");\n                        //figure statt div, weil div unter activityinstance ist css vorgeschrieben: inline-block\n                        popover.className = \"popover_content\";\n                        //popover.textContent = \"text text text\";\n                        //evtl. noch if isvisible:\n                        //https://stackoverflow.com/questions/152975/how-do-i-detect-a-click-outside-an-element\n                        //clicklistener entfernen?\n                        //https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\n                        //bei Klick ausserhalb schliessen: //https://www.w3schools.com/howto/howto_css_modals.asp\n                        //https://stackoverflow.com/questions/152975/how-do-i-detect-a-click-outside-an-element\n                        //https://css-tricks.com/dangers-stopping-event-propagation/\n                        document.addEventListener(\"click\", function(event) {\n                            if(!popover.contains(event.target) && !container.contains(event.target))\n                            {\n                                //hide if click is outside popover and main feedback button\n                                popover.classList.remove(\"popover_visible\");\n                                window.console.log(\"klick nicht auf popover\");\n                            }\n                            else {\n                                window.console.log(\"klick ist auf popover\");\n                            }\n                        });\n                        //close visible popover if escape is pressed\n                        document.addEventListener(\"keyup\", function(event) {\n                            if (event.which === 27) {\n                                let visiblePopover = document.querySelector(\"figure.popover_content.popover_visible\");\n                                if(visiblePopover !== undefined && visiblePopover !== null) {\n                                    visiblePopover.classList.remove(\"popover_visible\");\n                                }\n                            }\n                        });\n\n                        // feedback buttons for option 1 to max. 7, max. number of elements is given by length of pixData array\n                        for (let num = 1; num <= 7 && num <= pixData.length; num++) {\n                            let figureOpt = document.createElement(\"figure\");\n                            figureOpt.id = \"figureopt\" + num;//todolig\n                            figureOpt.className = \"block_activityfeedback_figopt\";\n                            let imgOpt = document.createElement(\"img\");\n                            imgOpt.className = \"block_activityfeedback_btn\";\n                            imgOpt.src = pixData[num - 1].url;\n                            imgOpt.alt = pixData[num - 1].name;\n                            imgOpt.setAttribute(\"data-cmid\", courseModuleId);\n                            imgOpt.setAttribute(\"data-fbid\", pixData[num - 1].key);\n                            imgOpt.setAttribute(\"data-fbname\", pixData[num - 1].name);\n                            let figCaptOpt = document.createElement(\"figcaption\");\n                            figCaptOpt.textContent = pixData[num - 1].name;\n                            figureOpt.append(imgOpt, figCaptOpt);\n                            //figureOpt.append(imgOpt);\n                            popover.append(figureOpt);\n                            //popover.append(imgOpt);\n                            //container.append(figureOpt);\n                        }\n\n                        container.append(imgMain, popover);\n\n                        //statt innerHTML immer textContent verwenden aus Sich.gründen bei rein Text\n                        activityInstance.appendChild(container);\n                    }\n                }\n                // main buttons for feedbacks\n                // (= neutral button which is shown before any feedback button is chosen)\n                let fbMainBtns = document.getElementsByClassName(\"block_activityfeedback_btn_main\");\n                for (let btn of fbMainBtns) {\n                    btn.addEventListener('click', function () {\n                        openFeedback(this);\n                    });\n                }\n                // feedback buttons\n                let fbBtns = document.getElementsByClassName(\"block_activityfeedback_btn\");\n                for (let btn of fbBtns) {\n                    btn.addEventListener('click', function () {\n                        setFeedback(this,courseid,userid);\n                    });\n                }\n                // muss hier im done sein, weil sonst evtl. Attribut nicht gefunden wird!\n                getFeedback(courseid, userid);\n                //});\n                window.console.log(\"displayPictures: end done\");\n            }, //).catch(Notification.exception); //\n            fail: notification.exception\n            //todolig: unklar wann .fail/.catch, wann hier mit Doppelpunkt\n        }\n    ]);\n    window.console.log(\"displayPictures: end\");\n}\nfunction openFeedback(mainBtn)\n{\n    const cmId = mainBtn.getAttribute(\"data-cmid\");\n    window.console.log(\"openFeedback\");\n    window.console.log(cmId);\n    //siehe https://docs.moodle.org/dev/Web_service_API_functions\n    //mod_data für DB-Zugriffe, aber nicht via Ajax:( z.B. mod_data_add_entry\n    //mainBtn.classList.add(\"popover_visible\");\n    let popover = mainBtn.nextElementSibling;\n    //toggle visible\n    if(popover.classList.contains(\"popover_visible\"))\n    {\n        popover.classList.remove(\"popover_visible\");\n    }\n    else {\n        //set first other visible popover to not visible\n        // so that never two popovers are visible at the same time\n        let visiblePopover = document.querySelector(\"figure.popover_content.popover_visible\");\n        if(visiblePopover !== undefined && visiblePopover !== null) {\n            visiblePopover.classList.remove(\"popover_visible\");\n        }\n        popover.classList.add(\"popover_visible\"); //toggle\n    }\n}\nfunction getFeedback(courseid, userid) {\n    window.console.log(\"getFeedback: start\");\n    window.console.log(\"config2: \");\n    //window.console.log(mdlcfg.wwwroot);\n    window.console.log(window.rootPath);\n    Ajax.call([\n        {\n            methodname: 'block_activityfeedback_get_feedback_data',\n            args: {\n                courseid: courseid\n            },\n            done: function (fbData) {\n                window.console.log(\"getFeedback: start done\");\n\n                let isBtnMainUpdated = false;\n\n                //todolig: zuerst einfahc mal zurücksetzen, weil evtl. von DB kein Datensatz mehr, da gelöscht\n                // auch für OptButtons\n                // let fbMainBtns = document.getElementsByClassName(\"block_activityfeedback_btn_main\");\n                // for (let btn of fbMainBtns) {\n                //     btn.src = window.rootPath + \"/blocks/activityfeedback/pix/thumbsup.png\";\n                // }\n\n                //https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach\n                //ajaxResult0.forEach(function(fbitem) {\n                //siehe generell als Tipp: https://www.learningrobo.com/2021/10/modern-feedback-form-using-html-css.html\n                for (const fbItem of fbData) {\n                    if (fbItem.userid === userid) {\n                let container = document.querySelector(`figure.block_activityfeedback_container[data-cmid=\"${fbItem.cmid}\"]`);\n                        let btnMain = document.querySelector(`img.block_activityfeedback_btn_main[data-cmid=\"${fbItem.cmid}\"]`);\n                        //container sollte es nur 1 geben mit dieser id\n                        // document.getElementsByClassName(\"block_activityfeedback_container\")\n                        // let fbnotselected = container.getElementsByClassName(\"block_activityfeedback_btn\")\n                        //     .not(`[data-fbid=\"{fbitem.fbid}\"]`);\n                        // //todolig: zuerst entfernen\n                        // fbnotselected.classList.remove(\"block_activityfeedback_selected\");\n                        // fbnotselected.classList.add(\"block_activityfeedback_not_selected\");\n                        // let fbselected = container.getElementsByClassName(\"block_activityfeedback_btn\")\n                        //     .querySelector(`[data-fbid=\"{fbitem.fbid}\"]`);\n\n                        // statt hinzu/entfernen mit toggle: x.classList.toggle(\"fa-thumbs-down\");\n                        //https://www.w3schools.com/howto/howto_js_toggle_like.asp\n                        if (container !== undefined && container !== null) { // needed if course_module was deleted\n                            let fbPix = container.querySelectorAll(\"img.block_activityfeedback_btn\");\n\n\n                            for (let pix of fbPix) {\n                                if (pix.getAttribute(\"data-fbid\") == fbItem.fbid) {\n                                    window.console.log(\"pix true\");\n                                    btnMain.src = pix.getAttribute(\"src\"); //get src as it is, not resolved\n                                    isBtnMainUpdated = true;\n                                    pix.classList.remove(\"block_activityfeedback_not_selected\");\n                                    pix.classList.add(\"block_activityfeedback_selected\");\n                                } else {\n                                    window.console.log(\"pix false\");\n                                    pix.classList.remove(\"block_activityfeedback_selected\");\n                                    pix.classList.add(\"block_activityfeedback_not_selected\");\n                                }\n                            }\n                            if(!isBtnMainUpdated)\n                            {\n                                btnMain.src = window.rootPath + \"/blocks/activityfeedback/pix/thumbsup.png\";\n                                isBtnMainUpdated = true;\n                            }\n                        }\n                    }\n                }//);\n\n                // auch falls zu kurs/user gar nichts auf DB\n                //if no feedback option is set, reset main button\n                // if (!isBtnMainUpdated) {\n                //     //todolig: import core/config nicht funktioniert, daher globa\n                //     //alternativ als param an jed. Fkt. übergeb\n                //     let fbMainBtns = document.getElementsByClassName(\"block_activityfeedback_btn_main\");\n                //     for (let btn of fbMainBtns) {\n                //         btn.src = window.rootPath + \"/blocks/activityfeedback/pix/thumbsup.png\";\n                //     }\n                // }\n\n\n                window.console.log(\"getFeedback: end done\");\n            },\n            fail: notification.exception\n            //todolig: unklar wann .fail/.catch, wann hier mit Doppelpunkt\n        }\n    ]);\n    window.console.log(\"getFeedback: end\");\n}\nfunction getFeedbackForActivity(cmid, userid) {\n    window.console.log(\"getFeedbackForActivity: start\");\n    window.console.log(userid); // todolig userid ganz entfernen, spätere Prüfung bereits entfernt\n\n    Ajax.call([\n        {\n            methodname: 'block_activityfeedback_get_feedback_activity',\n            args: {\n                cmid: cmid\n            },\n            done: function (fbData) {\n                window.console.log(\"getFeedbackForActivity: start done\");\n\n                let isBtnMainUpdated = false;\n\n                // //todolig: zuerst einfahc mal zurücksetzen, weil evtl. von DB kein Datensatz mehr, da gelöscht\n                // // auch für OptButtons\n                // let fbMainBtns = document.getElementsByClassName(\"block_activityfeedback_btn_main\");\n                // for (let btn of fbMainBtns) {\n                //     btn.src = window.rootPath + \"/blocks/activityfeedback/pix/thumbsup.png\";\n                // }\n\n                let fbItem = fbData[0];\n\n                let btnMain = document.querySelector(`img.block_activityfeedback_btn_main[data-cmid=\"${cmid}\"]`);\n\n                //if(fbItem !== undefined && fbItem !== null && fbItem.userid === userid) {\n                //if(fbItem.userid === userid)\n                    let container = document.querySelector(`figure.block_activityfeedback_container[data-cmid=\"${cmid}\"]`);\n\n                    // statt hinzu/entfernen mit toggle: x.classList.toggle(\"fa-thumbs-down\");\n                    //https://www.w3schools.com/howto/howto_js_toggle_like.asp\n                    if (container !== undefined && container !== null) { // needed if course_module was deleted\n                        let fbPix = container.querySelectorAll(\"img.block_activityfeedback_btn\");\n\n                        for (let pix of fbPix) {\n                            if (fbItem === undefined || fbItem === null) {\n                                window.console.log(\"pix neutral\");\n                                pix.classList.remove(\"block_activityfeedback_selected\");\n                                pix.classList.remove(\"block_activityfeedback_not_selected\");\n                            }\n                            else if (pix.getAttribute(\"data-fbid\") == fbItem.fbid) {\n                                window.console.log(\"pix true\");\n                                btnMain.src = pix.getAttribute(\"src\"); //get src as it is, not resolved\n                                isBtnMainUpdated = true;\n                                pix.classList.remove(\"block_activityfeedback_not_selected\");\n                                pix.classList.add(\"block_activityfeedback_selected\");\n                            }\n                            else {\n                                window.console.log(\"pix false\");\n                                pix.classList.remove(\"block_activityfeedback_selected\");\n                                pix.classList.add(\"block_activityfeedback_not_selected\");\n                            }\n                        }\n                    }\n                //}\n\n                if(!isBtnMainUpdated)\n                {\n                    btnMain.src = window.rootPath + \"/blocks/activityfeedback/pix/thumbsup.png\";\n                    isBtnMainUpdated = true;\n\n\n                }\n\n                // auch falls zu kurs/user gar nichts auf DB\n                //if no feedback option is set, reset main button\n                // if (!isBtnMainUpdated) {\n                //     //todolig: import core/config nicht funktioniert, daher globa\n                //     //alternativ als param an jed. Fkt. übergeb\n                //     let fbMainBtns = document.getElementsByClassName(\"block_activityfeedback_btn_main\");\n                //     for (let btn of fbMainBtns) {\n                //         btn.src = window.rootPath + \"/blocks/activityfeedback/pix/thumbsup.png\";\n                //     }\n                // }\n\n\n                window.console.log(\"getFeedback: end done\");\n            },\n            fail: notification.exception\n            //todolig: unklar wann .fail/.catch, wann hier mit Doppelpunkt\n        }\n    ]);\n    window.console.log(\"getFeedback: end\");\n}\nfunction setFeedback(btn,courseid,userid)\n{\n    window.console.log(\"setFeedback: start\");\n    //siehe https://docs.moodle.org/dev/Web_service_API_functions\n    //mod_data für DB-Zugriffe, aber nicht via Ajax:( z.B. mod_data_add_entry\n\n    // for fast reaction, todolig pruefen\n    //this.classList.remove(\"block_activityfeedback_not_selected\");\n    //evtl. mit toggle, auch deselekt., evtl. sieht man gar nicht mehr\n    btn.classList.add(\"block_activityfeedback_selected\");\n\n    const cmid = btn.getAttribute(\"data-cmid\");\n    const fbid = btn.getAttribute(\"data-fbid\");\n    const fbname = btn.getAttribute(\"data-fbname\");\n\n    //popover not visible if feedback option was selected\n    let popover = btn.parentElement.parentElement;\n    popover.classList.remove(\"popover_visible\");\n    //mainBtn auch grad direkt setzen ohne Server AW\n    //todolig: aber delete?\n    let mainBtn = popover.previousElementSibling;\n    mainBtn.src = btn.getAttribute(\"src\");\n\n    Ajax.call([\n        {\n            methodname: 'block_activityfeedback_set_feedback_data',\n            args: {\n                cmid: cmid, //event.data.moduleId,\n                fbid: fbid,//event.data.reactionSelect,\n                fbname: fbname\n                // sql function (insert/update/delete)\n                // is defined by server\n            },\n            done: function () {\n                window.console.log(\"setFeedback: start done\");\n                //getFeedback(courseid,userid);\n                getFeedbackForActivity(cmid, userid);\n                window.console.log(\"setFeedback: end done\");\n            },\n            fail: notification.exception\n            //todolig: unklar wann .fail/.catch, wann hier mit Doppelpunkt\n        }\n    ]);\n    window.console.log(\"setFeedback: end\");\n}\n//todolig: fuer str.get_string, fkt. zwar, aber gibt neu davor Exception: testjs.js:1 Uncaught undefined\n// https://docs.moodle.org/dev/Useful_core_Javascript_modules#Language_strings_.28core.2Fstr.29\n// require(['core/str'], function(str) {\n//     // start retrieving the localized string; store the promise that some time in the future the string will be there.\n//     var editaPresent = str.get_string('activityfeedback', 'block_activityfeedback');\n//     // as soon as the string is retrieved, i.e. the promise has been fulfilled,\n//     // edit the text of a UI element so that it then is the localized string\n//     // Note: $.when can be used with an arbitrary number of promised things\n//     jQuery.when(editaPresent).done(function(localizedEditString) {\n//         window.console.log(localizedEditString);\n//     });\n// });\n\n//https://docs.moodle.org/dev/AJAX\nrequire(['core/ajax'], function(ajax) {\n    var promises = ajax.call([\n        {methodname: 'core_get_string', args: {component: 'block_activityfeedback', stringid: 'activityfeedback'}}\n    ]);\n\n    promises[0].done(function (response) {\n        window.console.log('block_activityfeedback/activityfeedback is' + response);\n    }).fail(function (ex) {\n        window.console.log(ex);// do something with the exception\n    });\n});\n\n//https://docs.moodle.org/dev/Javascript_Modules\n//const formal = () => Str.get_string('activityfeedback', 'block_activityfeedback', '');"],"file":"module.min.js"}
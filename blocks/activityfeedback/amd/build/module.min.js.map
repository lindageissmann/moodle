{"version":3,"sources":["../src/module.js"],"names":["init","args","userid","parseInt","courseid","rootPath","rootpath","displayPictures","window","console","log","Ajax","call","methodname","done","pixData","activities","document","getElementsByClassName","activity","activityInstance","courseModuleId","id","substring","container","createElement","className","setAttribute","imgMain","src","classList","add","popover","num","figureOpt","length","imgOpt","url","alt","name","key","figCaptOpt","textContent","append","appendChild","fbMainBtns","btn","addEventListener","openFeedback","fbBtns","cmid","getAttribute","fbid","fbname","setFeedback","getFeedback","fail","notification","exception","mainBtn","cmId","nextElementSibling","toggle","fbData","fbItem","querySelector","fbPix","querySelectorAll","pix","remove","func","require","ajax","promises","component","stringid","response","ex"],"mappings":"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","sourcesContent":["//https://docs.moodle.org/dev/Javascript_Modules\n//only functions which are exported will be callable from outside the module\n//if the size of the params array is too large (> 1Kb), this will produce a developer warning. Do not attempt\n//to pass large amounts of data through this function, it will pollute the page size.\n//A preferred approach is to pass css selectors for DOM elements that contain data-attributes for any required data,\n//or fetch data via ajax in the background.\n//https://moodle.org/mod/forum/discuss.php?d=378112#p1524459\n// zwar veraltet, aber camel case hier ok: https://docs.moodle.org/dev/Javascript/Coding_Style\n// (auch in Bsp benutzt: https://docs.moodle.org/dev/Javascript_Modules)\n//todolig auf camelCase umstellen\n//import $ from 'jquery';\n//import jquery from 'jquery';\n//import * as Str from 'core/str';\nimport Ajax from 'core/ajax';\n//import {exception as displayError} from 'core/notification';\nimport notification from 'core/notification';\n//import bootstrap from bootstrap;\n//define(['jquery', 'core/ajax', 'core/notification']);\nexport const init = (args) => {\n    const userid = parseInt(args.userid);\n    const courseid = parseInt(args.courseid);\n    const rootPath = args.rootpath;\n    //const elems = document.querySelectorAll('[id^=module-]');\n    //warum fkt. hier jquery?\n    //jquery: .done(), .success, .fail, .always\n    //.then, .when\n    displayPictures(rootPath, courseid, userid);\n    //getFeedback(courseid, userid); // todolig! gibt hier race condition, dass getFeedback end done noch vor displayPict start done\n};\n\nfunction displayPictures(rootPath, courseid, userid)\n{\n    window.console.log(\"displayPictures: start\");\n    Ajax.call([\n        {\n            methodname: 'block_activityfeedback_get_pix_data',\n            args: {},\n            done: function (pixData) {\n                window.console.log(\"displayPictures: start done\");\n                const activities = document.getElementsByClassName(\"activity\");\n                for (const activity of activities)\n                {\n                    let activityInstance = activity.getElementsByClassName(\"activityinstance\")[0];\n                    // check if exists, because e.g. activity 'label' has no <div> child element with class 'activityinstance'\n                    if(activityInstance !== undefined && activityInstance !== null) {\n                        const courseModuleId = (activity.id).substring(7); // extract xx from id=module-xx\n                        let container = document.createElement(\"figure\");\n                        container.className = \"block_activityfeedback_container\";\n                        container.setAttribute(\"data-cmid\", courseModuleId);\n                        //node.classList.add('MyClass');\n                        // main button for feedback\n                        //let figureMain = document.createElement(\"figure\");\n                        let imgMain = document.createElement(\"img\");\n                        imgMain.className = \"block_activityfeedback_btn_main\";\n                        imgMain.src = rootPath + \"/blocks/activityfeedback/pix/thumbsup.png\";//todo: bild eckig via css rund machen\n                        //imgMain.alt = Str.get_string('activityfeedback', 'block_activityfeedback'); //todolig\n                        imgMain.setAttribute(\"data-cmid\", courseModuleId);\n                        //let figCaptMain = document.createElement(\"figcaption\");\n                        //figCaptMain.textContent = Str.get_string('activityfeedback', 'block_activityfeedback');\n                        //window.console.log(Str.get_string('activityfeedback', 'block_activityfeedback'));\n                        //window.console.log(formal);\n                        //figureMain.append(imgMain, figCaptMain);\n                        //container.append(figureMain);\n\n                        //Achtung: neu ist glaube ich scrollbalken wegen Bildern, auch senkrecht innerhalb!\n\n\n\n                        imgMain.classList.add(\"popover_title\");\n                        container.classList.add(\"popover_wrapper\");\n                        let popover = document.createElement(\"figure\");\n                        //figure statt div, weil div unter activityinstance ist css vorgeschrieben: inline-block\n                        popover.className = \"popover_content\";\n                        //popover.textContent = \"text text text\";\n                        //evtl. noch if isvisible:\n                        //https://stackoverflow.com/questions/152975/how-do-i-detect-a-click-outside-an-element\n                        //clicklistener entfernen?\n                        //https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\n                        //fkt. aktuell dann gar nicht mehr\n                        /*document.addEventListener(\"click\", function(event) {\n                            if(!popover.contains(event.target))\n                            {\n                                //hide\n                                //popover.style.display = \"none\";\n                                popover.classList.remove(\"popover_visible\");\n                            }\n                        });*/\n\n                        // feedback buttons for option 1 to max. 7, max. number of elements is given by length of pixData array\n                        for (let num = 1; num <= 7 && num <= pixData.length; num++) {\n                            let figureOpt = document.createElement(\"figure\");\n                            figureOpt.id = \"figureopt\" + num;//todolig\n                            figureOpt.className = \"block_activityfeedback_figopt\";\n                            let imgOpt = document.createElement(\"img\");\n                            imgOpt.className = \"block_activityfeedback_btn\";\n                            imgOpt.src = pixData[num - 1].url;\n                            imgOpt.alt = pixData[num - 1].name;\n                            imgOpt.setAttribute(\"data-cmid\", courseModuleId);\n                            imgOpt.setAttribute(\"data-fbid\", pixData[num - 1].key);\n                            imgOpt.setAttribute(\"data-fbname\", pixData[num - 1].name);\n                            let figCaptOpt = document.createElement(\"figcaption\");\n                            figCaptOpt.textContent = pixData[num - 1].name;\n                            figureOpt.append(imgOpt, figCaptOpt);\n                            //figureOpt.append(imgOpt);\n                            popover.append(figureOpt);\n                            //popover.append(imgOpt);\n                            //container.append(figureOpt);\n                        }\n\n                        container.append(imgMain, popover);\n\n                        //statt innerHTML immer textContent verwenden aus Sich.gründen bei rein Text\n                        activityInstance.appendChild(container);\n                    }\n                }\n                // main buttons for feedbacks\n                // (= neutral button which is shown before any feedback button is chosen)\n                let fbMainBtns = document.getElementsByClassName(\"block_activityfeedback_btn_main\");\n                for (let btn of fbMainBtns) {\n                    btn.addEventListener('click', function () {\n                        //const cmId = this.getAttribute(\"data-cmid\");\n                        openFeedback(this);\n                    });\n                }\n                // feedback buttons\n                let fbBtns = document.getElementsByClassName(\"block_activityfeedback_btn\");\n                for (let btn of fbBtns) {\n                    btn.addEventListener('click', function () {\n                        // for fast reaction, todolig pruefen\n                        //this.classList.remove(\"block_activityfeedback_not_selected\");\n                        this.classList.add(\"block_activityfeedback_selected\");\n\n                        const cmid = this.getAttribute(\"data-cmid\");\n                        const fbid = this.getAttribute(\"data-fbid\");\n                        const fbname = this.getAttribute(\"data-fbname\");\n                        setFeedback(cmid,fbid,fbname,courseid,userid);\n                    });\n                }\n                // muss hier im done sein, weil sonst evtl. Attribut nicht gefunden wird!\n                getFeedback(courseid, userid);\n                //});\n                window.console.log(\"displayPictures: end done\");\n            }, //).catch(Notification.exception); //\n            fail: notification.exception\n            //todolig: unklar wann .fail/.catch, wann hier mit Doppelpunkt\n        }\n    ]);\n    window.console.log(\"displayPictures: end\");\n}\nfunction openFeedback(mainBtn)\n{\n    const cmId = mainBtn.getAttribute(\"data-cmid\");\n    window.console.log(\"openFeedback\");\n    window.console.log(cmId);\n    //siehe https://docs.moodle.org/dev/Web_service_API_functions\n    //mod_data für DB-Zugriffe, aber nicht via Ajax:( z.B. mod_data_add_entry\n    //mainBtn.classList.add(\"popover_visible\");\n    let popover = mainBtn.nextElementSibling;\n    popover.classList.toggle(\"popover_visible\");\n    //bei Klick ausserhalb schliessen: //https://www.w3schools.com/howto/howto_css_modals.asp\n    //https://stackoverflow.com/questions/152975/how-do-i-detect-a-click-outside-an-element\n    //https://css-tricks.com/dangers-stopping-event-propagation/\n\n}\nfunction getFeedback(courseid, userid)\n{\n    window.console.log(\"getFeedback: start\");\n    Ajax.call([\n        {\n            methodname: 'block_activityfeedback_get_feedback_data',\n            args: {\n                courseid: courseid\n            },\n            done: function (fbData) {\n                window.console.log(\"getFeedback: start done\");\n\n                //https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach\n                //ajaxResult0.forEach(function(fbitem) {\n                //siehe generell als Tipp: https://www.learningrobo.com/2021/10/modern-feedback-form-using-html-css.html\n                for (const fbItem of fbData) {\n                    if(fbItem.userid === userid)\n                    {\n                        let container=document.querySelector(`figure.block_activityfeedback_container[data-cmid=\"${fbItem.cmid}\"]`);\n                        //container sollte es nur 1 geben mit dieser id\n                        // document.getElementsByClassName(\"block_activityfeedback_container\")\n                        // let fbnotselected = container.getElementsByClassName(\"block_activityfeedback_btn\")\n                        //     .not(`[data-fbid=\"{fbitem.fbid}\"]`);\n                        // //todolig: zuerst entfernen\n                        // fbnotselected.classList.remove(\"block_activityfeedback_selected\");\n                        // fbnotselected.classList.add(\"block_activityfeedback_not_selected\");\n                        // let fbselected = container.getElementsByClassName(\"block_activityfeedback_btn\")\n                        //     .querySelector(`[data-fbid=\"{fbitem.fbid}\"]`);\n\n                        // statt hinzu/entfernen mit toggle: x.classList.toggle(\"fa-thumbs-down\");\n                        //https://www.w3schools.com/howto/howto_js_toggle_like.asp\n                        if(container !== undefined && container !== null) { // needed if course_module was deleted\n                            let fbPix = container.querySelectorAll(\"img.block_activityfeedback_btn\");\n\n                            for (let pix of fbPix) {\n                                if(pix.getAttribute(\"data-fbid\") == fbItem.fbid) {\n                                    window.console.log(\"pix true\");\n                                    pix.classList.remove(\"block_activityfeedback_not_selected\");\n                                    pix.classList.add(\"block_activityfeedback_selected\");\n                                }\n                                else {\n                                    window.console.log(\"pix false\");\n                                    pix.classList.remove(\"block_activityfeedback_selected\");\n                                    pix.classList.add(\"block_activityfeedback_not_selected\");\n                                }\n                            }\n                    // let fbSelected = container.querySelector(`img.block_activityfeedback_btn[data-fbid=\"${fbItem.fbid}\"]`);\n                            // fbSelected.classList.remove(\"block_activityfeedback_not_selected\");\n                            // fbSelected.classList.add(\"block_activityfeedback_selected\");\n                        }\n                    }\n                }//);\n                window.console.log(\"getFeedback: end done\");\n            },\n            fail: notification.exception\n            //todolig: unklar wann .fail/.catch, wann hier mit Doppelpunkt\n        }\n    ]);\n    window.console.log(\"getFeedback: end\");\n}\nfunction setFeedback(cmid,fbid,fbname,courseid,userid)\n{\n    window.console.log(\"setFeedback: start\");\n    //siehe https://docs.moodle.org/dev/Web_service_API_functions\n    //mod_data für DB-Zugriffe, aber nicht via Ajax:( z.B. mod_data_add_entry\n\n    Ajax.call([\n        {\n            methodname: 'block_activityfeedback_set_feedback_data',\n            args: {\n                func: 'insert',\n                cmid: cmid, //event.data.moduleId,\n                fbid: fbid,//event.data.reactionSelect,\n                fbname: fbname\n            },\n            done: function () {\n                window.console.log(\"setFeedback: start done\");\n                getFeedback(courseid,userid);\n                window.console.log(\"setFeedback: end done\");\n            },\n            fail: notification.exception\n            //todolig: unklar wann .fail/.catch, wann hier mit Doppelpunkt\n        }\n    ]);\n    window.console.log(\"setFeedback: end\");\n}\n//todolig: fuer str.get_string, fkt. zwar, aber gibt neu davor Exception: testjs.js:1 Uncaught undefined\n// https://docs.moodle.org/dev/Useful_core_Javascript_modules#Language_strings_.28core.2Fstr.29\n// require(['core/str'], function(str) {\n//     // start retrieving the localized string; store the promise that some time in the future the string will be there.\n//     var editaPresent = str.get_string('activityfeedback', 'block_activityfeedback');\n//     // as soon as the string is retrieved, i.e. the promise has been fulfilled,\n//     // edit the text of a UI element so that it then is the localized string\n//     // Note: $.when can be used with an arbitrary number of promised things\n//     jQuery.when(editaPresent).done(function(localizedEditString) {\n//         window.console.log(localizedEditString);\n//     });\n// });\n\n//https://docs.moodle.org/dev/AJAX\nrequire(['core/ajax'], function(ajax) {\n    var promises = ajax.call([\n        {methodname: 'core_get_string', args: {component: 'block_activityfeedback', stringid: 'activityfeedback'}}\n    ]);\n\n    promises[0].done(function (response) {\n        window.console.log('block_activityfeedback/activityfeedback is' + response);\n    }).fail(function (ex) {\n        window.console.log(ex);// do something with the exception\n    });\n});\n\n//https://docs.moodle.org/dev/Javascript_Modules\n//const formal = () => Str.get_string('activityfeedback', 'block_activityfeedback', '');"],"file":"module.min.js"}
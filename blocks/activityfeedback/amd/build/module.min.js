define ("block_activityfeedback/module",["exports","core/ajax","core/notification"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=d(b);c=d(c);function d(a){return a&&a.__esModule?a:{default:a}}function e(a){if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(a=f(a))){var b=0,c=function(){};return{s:c,n:function n(){if(b>=a.length)return{done:!0};return{done:!1,value:a[b++]}},e:function e(a){throw a},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,e=!0,g=!1,h;return{s:function s(){d=a[Symbol.iterator]()},n:function n(){var a=d.next();e=a.done;return a},e:function e(a){g=!0;h=a},f:function f(){try{if(!e&&null!=d.return)d.return()}finally{if(g)throw h}}}}function f(a,b){if(!a)return;if("string"==typeof a)return g(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return g(a,b)}function g(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}a.init=function init(a){var b=parseInt(a.userid),c=parseInt(a.courseid),d=a.rootpath;h(d,c,b)};function h(a,d,f){window.console.log("displayPictures: start");b.default.call([{methodname:"block_activityfeedback_get_pix_data",args:{},done:function done(b){window.console.log("displayPictures: start done");var c=document.getElementsByClassName("activity"),g=e(c),h;try{for(g.s();!(h=g.n()).done;){var l=h.value,m=l.getElementsByClassName("activityinstance")[0];if(m!==void 0&&null!==m){var n=l.id.substring(7),o=document.createElement("figure");o.className="block_activityfeedback_container";o.setAttribute("data-cmid",n);var p=document.createElement("figure"),q=document.createElement("img");q.className="block_activityfeedback_btn_main";q.src=a+"/blocks/activityfeedback/pix/thumbsup.png";q.setAttribute("data-cmid",n);var x=document.createElement("figcaption");p.append(q,x);o.append(p);for(var y=1,z;7>=y&&y<=b.length;y++){z=document.createElement("figure");z.id="figureopt"+y;var A=document.createElement("img");A.className="block_activityfeedback_btn";A.src=b[y-1].url;A.alt=b[y-1].name;A.setAttribute("data-cmid",n);A.setAttribute("data-fbid",b[y-1].key);A.setAttribute("data-fbname",b[y-1].name);var B=document.createElement("figcaption");B.textContent=b[y-1].name;z.append(A,B);o.append(z)}m.appendChild(o)}}}catch(a){g.e(a)}finally{g.f()}var r=document.getElementsByClassName("block_activityfeedback_btn_main"),s=e(r),t;try{for(s.s();!(t=s.n()).done;){var C=t.value;C.addEventListener("click",function(){var a=this.getAttribute("data-cmid");j(a)})}}catch(a){s.e(a)}finally{s.f()}var u=document.getElementsByClassName("block_activityfeedback_btn"),v=e(u),w;try{for(v.s();!(w=v.n()).done;){var D=w.value;D.addEventListener("click",function(){this.classList.add("block_activityfeedback_selected");var a=this.getAttribute("data-cmid"),b=this.getAttribute("data-fbid"),c=this.getAttribute("data-fbname");k(a,b,c,d,f)})}}catch(a){v.e(a)}finally{v.f()}i(d,f);window.console.log("displayPictures: end done")},fail:c.default.exception}]);window.console.log("displayPictures: end")}function i(a,d){window.console.log("getFeedback: start");b.default.call([{methodname:"block_activityfeedback_get_feedback_data",args:{courseid:a},done:function done(a){window.console.log("getFeedback: start done");var b=e(a),c;try{for(b.s();!(c=b.n()).done;){var i=c.value;if(i.userid===d){var j=document.querySelector("figure.block_activityfeedback_container[data-cmid=\"".concat(i.cmid,"\"]"));if(j!==void 0&&null!==j){var f=j.querySelectorAll("img.block_activityfeedback_btn"),g=e(f),h;try{for(g.s();!(h=g.n()).done;){var k=h.value;if(k.getAttribute("data-fbid")==i.fbid){window.console.log("pix true");k.classList.remove("block_activityfeedback_not_selected");k.classList.add("block_activityfeedback_selected")}else{window.console.log("pix false");k.classList.remove("block_activityfeedback_selected");k.classList.add("block_activityfeedback_not_selected")}}}catch(a){g.e(a)}finally{g.f()}}}}}catch(a){b.e(a)}finally{b.f()}window.console.log("getFeedback: end done")},fail:c.default.exception}]);window.console.log("getFeedback: end")}function j(a){window.console.log("openFeedback");window.console.log(a)}function k(a,d,e,f,g){window.console.log("setFeedback: start");b.default.call([{methodname:"block_activityfeedback_set_feedback_data",args:{func:"insert",cmid:a,fbid:d,fbname:e},done:function done(){window.console.log("setFeedback: start done");i(f,g);window.console.log("setFeedback: end done")},fail:c.default.exception}]);window.console.log("setFeedback: end")}require(["core/ajax"],function(a){var b=a.call([{methodname:"core_get_string",args:{component:"block_activityfeedback",stringid:"activityfeedback"}}]);b[0].done(function(a){window.console.log("block_activityfeedback/activityfeedback is"+a)}).fail(function(a){window.console.log(a)})})});
//# sourceMappingURL=module.min.js.map
